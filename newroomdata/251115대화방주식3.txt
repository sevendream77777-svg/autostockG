
[HOJ/SLE PROJECT ROOM FULL RESTORE FILE]
---------------------------------------

※ 목적: 이 방의 핵심 진행내용을 최대한 많이 보존하여 메모리 이슈 발생 시 새 방에서 그대로 이어서 작업하기 위함.
※ 아래 내용은 ChatGPT가 접근 가능한 대화 범위 전체를 기반으로 구성됨.

============================================================
1. 전체 프로젝트 구조 요약
============================================================
- 프로젝트 루트: F:\autostockG\
- HOJ / SLE 엔진 개발 및 자동화 파이프라인
- 연구용 DB → 실전 DB → 실전 엔진 → UI → 카카오톡 연동
- 데이터 업데이트(일별/증분), 엔진 재학습, UI 구성, 테스트 스크립트, 백업 체계 수립까지 모두 포함

------------------------------------------------------------
폴더구조 (최종 확정안)
------------------------------------------------------------
F:\autostockG\
│
├── HOJ_DB\
│     ├── RESEARCH\
│     │      ├── HOJ_DB_RESEARCH_V25.parquet
│     │      ├── …
│     └── REAL\
│            ├── HOJ_DB_REAL_V25.parquet
│            ├── …
│
├── HOJ_ENGINE\
│     ├── RESEARCH\
│     │      ├── HOJ_ENGINE_RESEARCH_V25.pkl
│     └── REAL\
│            ├── HOJ_ENGINE_REAL_V25.pkl
│
├── SLE_DB\
├── SLE_ENGINE\
│
├── ui\
│    ├── ui_app.py
│    └── ui_pages\dashboard/predict_stock/engine_manager…
│
└── 업데이트/크롤러/병합 스크립트 일체

============================================================
2. 데이터 파이프라인 핵심 요약
============================================================
1) KRX 거래일 확보  
2) 종목 리스트 확보  
3) 시세 다운로드  
4) 기술지표 피처 생성  
5) PER/PBR/수급 데이터 병합  
6) 최종 full DB(new_Hoj_DB_V25_FULL.parquet) 구성  
7) CLEAN 버전 생성 (KOSPI_Close 등 제거)  
8) 연구용 DB 생성  
9) 실전 DB 생성  
10) 엔진 학습(회귀/분류 LightGBM)  
11) 실전 엔진 생성  

============================================================
3. 엔진 학습 구조
============================================================
회귀 모델 (Expected_Return_5d)
- LightGBM Regressor
- 주요 피처 15개
- Early stopping 46회
- RMSE ≈ 0.0735

분류 모델 (Label_5d)
- LightGBM Classifier
- Early stopping 42회
- Logloss ≈ 0.6932

엔진 저장 형식 (딕셔너리):
{
   'reg_model': <LGBMRegressor>,
   'clf_model': <LGBMClassifier>,
   'feature_cols': [...]
}

============================================================
4. 파일명 표준화 규칙 (확정)
============================================================
HOJ_DB_RESEARCH_VXX.parquet  
HOJ_DB_REAL_VXX.parquet  
HOJ_ENGINE_RESEARCH_VXX.pkl  
HOJ_ENGINE_REAL_VXX.pkl  

백업:
backup\DB_REAL\V25_YYYYMMDD.parquet  
backup\ENGINE_REAL\V25_YYYYMMDD_HHMM.pkl  

============================================================
5. UI 구성 요약
============================================================
- Streamlit 기반
- 사이드바 메뉴:
  1. 대시보드
  2. 오늘 Top10 예측
  3. 개별 종목 예측
  4. 엔진 관리
  5. 데이터 업데이트
  6. 설정

각 메뉴 주요 기능:

[오늘 Top10]
- 최신 날짜의 100여 종목에서 top10 예측 표시

[개별 종목 예측]
- 종목코드 입력 → 5일 예측수익률 / 상승확률 표시  
- 오류 KeyError('reg') 문제 → 엔진 구조 점검으로 해결됨

[엔진 관리]
- 연구/실전 엔진 확인
- 버전별 선택 기능 향후 추가 예정

[데이터 업데이트]
- 단계별 스크립트 실행 (1~5단계)

============================================================
6. 주요 문제 해결 정리
============================================================
1) Streamlit 초기 오류: 모듈 import 경로 문제 → ui_pages 폴더명 수정  
2) 엔진 KeyError('reg'): 엔진 딕셔너리 구조 확인 후 로드 방식 교정  
3) test_REAL_Hoj_ENGINE_V25.py에서 old 파일명 로딩 오류 → HOJ_DB_REAL_V25로 수정  
4) 엔진/DB 버전 관리 → 폴더 구조 재정립  
5) 업데이트 스크립트 정상 작동 확인  

============================================================
7. 현재까지 완료된 핵심 성과
============================================================
✔ HOJ 연구/실전 DB 자동 구축  
✔ HOJ 연구/실전 엔진 자동 구축  
✔ 백업 체계 자동화  
✔ UI 기본 구조 완성  
✔ 업데이트 파이프라인 작동 확인  
✔ 전체 파일명/폴더 구조 표준화  

============================================================
8. 다음 단계 (확정된 작업)
============================================================
1) UI 개선 (버전 선택, 백테스트 기능 추가)  
2) 카카오톡 연동  
3) SLE 엔진 통합  
4) UI에서 엔진 테스트 자동화  
5) UI에서 수동 업데이트(1~5단계) 버튼 연결  

============================================================
9. 기타 참고된 모델/파일
============================================================
- new_Hoj_DB_V25_FULL.parquet  
- new_Hoj_DB_V25_FULL_CLEAN.parquet  
- update_features_incrementally.py  
- build_real_HOJ_V25.py  
- test_REAL_HOJ_ENGINE_V25.py  

============================================================
END OF RESTORE FILE
============================================================
